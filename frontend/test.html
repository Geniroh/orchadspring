<!DOCTYPE html>
<html>
<head>
    <title>Styled Checkbox with Number</title>
    <style>
        /* Hide the default checkbox */
        input[type="checkbox"] {
            display: none;
        }

        /* Style the custom checkbox container */
        .checkbox-container {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 2px solid #333; /* Border color */
            text-align: center;
            line-height: 30px; /* Vertically center the number */
            font-weight: bold;
            font-size: 16px;
            color: #333; /* Text color */
            cursor: pointer;
        }

        /* Style the custom checkbox when checked */
        input[type="checkbox"]:checked + .checkbox-container {
            background-color: #333; /* Background color when checked */
            color: #fff; /* Text color when checked */
        }
    </style>
</head>
<body>
    <!-- The custom checkbox -->
    <!-- {"body":{},"query":{"status":"completed","tx_ref":"596f7fdf-0687-4718-96fc-26109d954dff","transaction_id":"1053823108"}} -->
      <label>
        <input type="checkbox" class="hide-checkbox">
        <div class="checkbox-container">1</div>
      </label>

      <form action="/submitReservations" method="POST">
        <input type="checkbox" name="reservation[]" value="space_id_1,start_date_1,end_date_1">
        <!-- Add more checkboxes for other reservations -->
        <input type="checkbox" name="reservation[]" value="space_id_2,start_date_2,end_date_2">
        <!-- Add more checkboxes as needed -->
        <button type="submit">Submit Reservations</button>
    </form>
    
    <form id="reservationForm" action="/your-server-endpoint" method="post">
        <!-- Other form fields -->
    
        <!-- Hidden input field to store selectedSpaces as a JSON string -->
        <input type="hidden" name="selected_spaces" id="selectedSpacesField" value="">
    
        <!-- Submit button -->
        <button type="submit">Submit</button>
    </form>
</div>
<button type="button" id="start-payment-button" onclick="makePayment()">Pay Now</button>
</form>
<script>
function makePayment() {
  FlutterwaveCheckout({
    public_key: "FLWPUBK_TEST-SANDBOXDEMOKEY-X",
    tx_ref: "titanic-48981487343MDI0NzMx",
    amount: 54600,
    currency: "NGN",
    payment_options: "card, banktransfer, ussd",
    redirect_url: "https://glaciers.titanic.com/handle-flutterwave-payment",
    meta: {
      consumer_id: 23,
      consumer_mac: "92a3-912ba-1192a",
    },
    customer: {
      email: "rose@unsinkableship.com",
      phone_number: "08102909304",
      name: "Rose DeWitt Bukater",
    },
    customizations: {
      title: "The Titanic Store",
      description: "Payment for an awesome cruise",
      logo: "https://www.logolynx.com/images/logolynx/22/2239ca38f5505fbfce7e55bbc0604386.jpeg",
    },
  });
}
</script>

    <script>
                        // document.getElementById("reservationForm").addEventListener("submit", function(event) {
                //     event.preventDefault();
                    
                //     const selectedSpaces = [];
                    
                //     // Loop through checkboxes and collect selected ones
                //     const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                //     checkboxes.forEach(function(checkbox) {
                //         if (checkbox.checked) {
                //             selectedSpaces.push(checkbox.value);
                //         }
                //     });
    
                //     // Now, selectedSpaces array contains the selected space IDs
                //     console.log(selectedSpaces);
    
                //     // You can send the selectedSpaces data to your server here via AJAX or by setting a hidden field in the form
                //     // Example: <input type="hidden" name="selected_spaces" value="<%= JSON.stringify(selectedSpaces) %>">
                    
                //     // Finally, submit the form
                //     // event.target.submit();
                // });
                // document.getElementById("reservationForm").addEventListener("submit", function(event) {
                //     event.preventDefault();
                    
                //     const selectedSpaces = [];
                    
                //     // Loop through checkboxes and collect selected ones
                //     const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                //     checkboxes.forEach(function(checkbox) {
                //         if (checkbox.checked) {
                //             selectedSpaces.push(checkbox.value);
                //         }
                //     });
    
                //     // Update the hidden input field's value with the selectedSpaces JSON string
                //     document.getElementById("selectedSpacesField").value = JSON.stringify(selectedSpaces);
    
                //     // Finally, submit the form
                //     event.target.submit();
                // });

                // document.getElementById("reservationForm").addEventListener("submit", function(event) {
                //     event.preventDefault();
                    
                //     const selectedSpaces = []; // Initialize selectedSpaces array
                    
                //     // Loop through checkboxes and collect selected ones
                //     const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                //     checkboxes.forEach(function(checkbox) {
                //         if (checkbox.checked) {
                //             selectedSpaces.push(checkbox.value);
                //         }
                //     });

                //     // Now, selectedSpaces array contains the selected space IDs
                //     console.log(selectedSpaces);

                //     // Send the selectedSpaces data to your server here via AJAX or by setting a hidden field in the form
                //     // Example: <input type="hidden" name="selected_spaces" value="<%= JSON.stringify(selectedSpaces) %>">
                    
                //     // Finally, submit the form
                //     event.target.submit();
                // });
    </script>
    
</body>
</html>



<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Submission</title>
</head>
<body>
    <form method="POST" action="https://checkout.flutterwave.com/v3/hosted/pay">
        <div>
          Your order is ₦3,400
        </div>
        <input type="hidden" name="FLWPUBK-767889f3e84565e2ea31f78a22575581-X" value="FLWPUBK-767889f3e84565e2ea31f78a22575581-X" />
        <input type="hidden" name="customer[email]" value="jessepinkman@walterwhite.org" />
        <input type="hidden" name="customer[name]" value="Jesse Pinkman" />
        <input type="hidden" name="tx_ref" value="bitethtx-019203" />
        <input type="hidden" name="amount" value="3400" />
        <input type="hidden" name="currency" value="NGN" />
        <input type="hidden" name="meta[token]" value="54" />
        <input type="hidden" name="redirect_url" value="https://google.com" />
        <button type="submit" class="btn" id="start-payment-button">Pay Now</button>
      </form>
</body>
</html> -->
<div class="col-27">
  <aside class="booking-sidebar">
      <h2 class="main-title">Payment Info</h2>

      <div class="widget">
          <h2 class="widget-title">Your price summary</h2>
          <div class="price-summary-top">
              <ul>
                  <li>Details</li>
                  <li>Amount</li>
              </ul>
          </div>
          <div class="alert alert-primary">
              <% if(reservation) { %>
                  <label>Your fee is: </label>
                  ₦ <%= reservation.price %>
              <% } %>
          </div>
          <div class="price-summary-detail" id="payment-container">
              <!-- <ul>
                  <li>Adult x 1 <span>$1,056</span></li>
                  <li>Tax x 1 <span>$35</span></li>
                  <li>Total Airfare: <span>$1,091</span></li>
                  <li>Discount<span>- $110</span></li>
                  <li>Total Payable<span>$981.00</span></li>
              </ul> -->

              <!-- <form method="POST" action="https://checkout.flutterwave.com/v3/hosted/pay">
                  <div>
                    Your order is ₦3,400
                  </div>
                  <input type="hidden" name="public_key" value="FLWPUBK-58cc63c00e129204fb4e94ef95bb781f-X" />
                  <input type="hidden" name="customer[email]" value="jessepinkman@walterwhite.org" />
                  <input type="hidden" name="customer[name]" value="Jesse Pinkman" />
                  <input type="hidden" name="tx_ref" value="bitethtx-019203" />
                  <input type="hidden" name="amount" value="3400" />
                  <input type="hidden" name="currency" value="NGN" />
                  <input type="hidden" name="meta[token]" value="54" />
                  <input type="hidden" name="redirect_url" value="https://google.com" />
                  <button type="submit" id="start-payment-button">Pay Now</button>
                </form> -->
                <form method="POST" action="https://checkout.flutterwave.com/v3/hosted/pay">
                  <!-- <div>
                    Your order is ₦3,400
                  </div> -->
                  <input type="hidden" name="public_key" value="FLWPUBK-767889f3e84565e2ea31f78a22575581-X" />
                  <input type="hidden" name="customer[email]" value="" id="payment-email" />
                  <input type="hidden" name="customer[name]" value="" id="payment-name" />
                  <input type="hidden" name="tx_ref" value="bitethtx-01920376889" />
                  <input type="hidden" name="amount" value="<%= reservation.price %>" id="payment-amount" />
                  <input type="hidden" name="currency" value="NGN" />
                  <input type="hidden" name="meta[token]" value="54" />
                  <input type="hidden" name="payment_options" value="card, ussd " />
                  <input type="hidden" name="redirect_url" value="https://localhost:8080/confirmation" />
                  <button type="submit" class="btn w-full" id="start-payment-button">Pay Now</button>
                  <!-- <button type="submit" class="btn" id="start-payment-button" style="width: 100%;">Pay Now</button> -->
                </form>
          </div>
      </div>
  </aside>
</div>

<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,900&display=swap" rel="stylesheet">
  </head>
    <style>
        h1 {
          color: #88B04B;
          font-family: "Nunito Sans", "Helvetica Neue", sans-serif;
          font-weight: 900;
          font-size: 40px;
          margin-bottom: 10px;
        }
        p {
          color: #404F5E;
          font-family: "Nunito Sans", "Helvetica Neue", sans-serif;
          font-size:20px;
          margin: 0;
        }
      i {
        color: #9ABC66;
        font-size: 100px;
        line-height: 200px;
        margin-left:-15px;
      }
      .card {
        background: white;
        padding: 60px;
        border-radius: 4px;
        box-shadow: 0 2px 3px #C8D0D8;
        display: inline-block;
        margin: 0 auto;
      }
    </style>
    <body>
      <div class="card">
      <div style="border-radius:200px; height:200px; width:200px; background: #F8FAF5; margin:0 auto;">
        <i class="checkmark">✓</i>
      </div>
        <h1>Success</h1> 
        <p>We received your purchase request;<br/> we'll be in touch shortly!</p>
      </div>

      <div class="checkbox-container" style="padding: 15px;" title="Single Spot">1</div>
    </body>


    <% if (deskspaces.length > 0) { %>
      <% deskspaces.forEach(function(space) { %>
          <label>
              <input type="checkbox" class="hide-checkbox" id="space_<%= space._id %>" data-space-price="<%= space.price %>" data-space-id="<%= space._id %>" name="space_id" value="<%= space._id %>" <%= isDayAvailable(space) ? '' : 'disabled' %>>
              <div class="checkbox-container" style="padding: 15px;" title="<%= space.name %>"><%= space.seat_number %></div>
          </label>
      <% }); %>
  <% } else { %>
      <p>No data available.</p>
  <% } %>
  
  <script>
  function isDayAvailable(space) {
      // Extract the overlapping reservation dates
      const overlappingDates = space.overlappingReservations.map(reservation => reservation.dates);
  
      // Get the current date in ISO format (e.g., "2023-09-08T23:00:00.000Z")
      const currentDate = new Date().toISOString().split('T')[0];
  
      // Check if the current date is in the overlapping reservation dates
      return !overlappingDates.some(dates => dates.includes(currentDate));
  }
  </script>
  
    <script>


const checkboxes = document.querySelectorAll('.hide-checkbox');
                checkboxes.forEach(async (checkbox) => {
                    const spaceId = checkbox.getAttribute('data-space-id');
                    
                    try {
                        const response = await axios.post('/api/reservation/check', {
                            space_id: spaceId,
                            start_date: queryParams.start_date, 
                            end_date: queryParams.end_date,
                        });
    
                        if (response.data.available) {
                            checkbox.checked = false; // Space is available
                        } else if (response.data.available == false && response.data.overlappingReservations.status === 'pending'){
                            checkbox.checked = true; // Space is not available
                            checkbox.disabled = true
                        } else {
                            checkbox.checked = true; // Space is not available
                            checkbox.disabled = true
                        }
                    } catch (error) {
                        console.error('Error checking availability:', error);
                    }
                });





    </script>
</html>